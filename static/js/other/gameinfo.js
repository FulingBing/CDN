function reOverTime(){stopall();ajax("../../RunCmd.do?cmd=pot re "+uuid+"&token="+token,"reData");}function changeinfo(c,t,r,u){stopall();ajax("../../ServerApi.do?changeinfo="+c+"&type="+t+"&res="+r+"&user="+u+"&token="+token,"reData");}function reData(i){
location.reload();}function getBtnList(o,n,t,r){var re="";for(var i=0;i<o.length;i++){if(owner==1){re=re+"<input type=\"button\" class=\"button_b\" value=\""+o[i].name+"\" onclick=\"changeinfo('"+n+"','"+t+"','"+r+"','"+o[i].name+"')\" onmouseover=\"this.value='删除'\""+
" onmouseout=\"this.value='"+o[i].name+"'\"/>";}else{re=re+o[i].name+",";}}if(owner==1){return re+"<input type=\"button\" class=\"button_r\" value=\"添加\" onclick=\"addUserInfo('"+n+"','"+t+"','"+r+"')\"/>";}else{return re;}}function addUserInfo(n,t,r){
var name=prompt("请输入ID","");if(name){if(name.length>0){changeinfo(n,t,r,name);}}}function getTimetn(t){var time=new Date(parseInt(t));var y=time.getFullYear();var M=time.getMonth()+1;var d=time.getDate();var h=time.getHours();var m=time.getMinutes();
var s=time.getSeconds();return re=y+'-'+addZero(M)+'-'+addZero(d)+' '+addZero(h)+':'+addZero(m)+':'+addZero(s);}function addZero(m){return m<10?'0'+m:m;}function loadUser(){ajax("../../ServerApi.do?player="+name+"&token="+token,"reloaduser");}function reloaduser(i){
var obj=eval("("+i+")");var h="<table class=\"tablecss\">"+"<tr><td>UUID</td><td>"+obj.uuid+"</td></tr>"+"<tr><td>血量</td><td>"+parseInt(obj.health)+"/"+parseInt(obj.maxhealth)+"</td></tr>"+"<tr><td>饱食度</td><td>"+parseInt(obj.fool)+"/20</td></tr>"+
"<tr><td>附魔等级</td><td>"+obj.level+"</td></tr>"+"<tr><td>坐标</td><td>"+obj.x+","+obj.y+","+obj.z+"&nbsp;("+obj.world+")</td></tr>"+"</table>";document.getElementById("info").innerHTML=h;h="<table class=\"tablecss\">"+"<thead><tr><td width=\"110px\">名称</td>"+
"<td width=\"90px\">所在世界</td><td width=\"190px\">有效期</td><td width=\"280px\">成员</td><td>封禁</td></tr></thead>";for(var i=0;i<obj.residence.length;i++){h=h+"<tr><td>"+obj.residence[i].name+"</td><td>"+obj.residence[i].world+"</td><td>"+getfrozen(obj.residence[i])+
"</td><td>"+getBtnList(obj.residence[i].trust,window.btoa(obj.residence[i].name),"trust","1")+"</td><td>"+getBtnList(obj.residence[i].ban,window.btoa(obj.residence[i].name),"ban","1")+"</td></tr>";}h=h+"</table>";document.getElementById("res").innerHTML=h;
h="<table class=\"tablecss\">"+"<thead><tr><td width=\"110px\">ID</td><td width=\"90px\">所在世界</td><td width=\"190px\">有效期</td><td width=\"280px\">成员</td><td>封禁</td></tr></thead>";for(var i=0;i<obj.plot.length;i++){h=h+"<tr><td>"+obj.plot[i].idx+","+
obj.plot[i].idz+"</td><td>"+obj.plot[i].world+"</td><td>"+getTimetn(obj.plot[i].overtime)+"</td><td>"+getBtnList(obj.plot[i].trust,window.btoa(obj.plot[i].world+","+obj.plot[i].idx+","+obj.plot[i].idz),"trust","0")+"</td><td>"+getBtnList(obj.plot[i].ban,window.btoa(obj.plot[i].world+","+
obj.plot[i].idx+","+obj.plot[i].idz),"ban","0")+"</td></tr>";}h=h+"</table>";document.getElementById("plot").innerHTML=h;var rebtn=document.getElementById("retime");if(rebtn){rebtn.style.display="";}}loadUser();function getfrozen(o){if(o.frozen=="-1"){var btn="";
if(owner==1){btn="<input type='button' class='button_b ende' value='冻结' onclick=\"setFrozen('"+o.name+"')\"/>";}return getTimetn(o.overtime)+btn;}else{return "<span class='c0088'>"+getTimetn(o.frozen)+"</span>";}}function setFrozen(n){
document.getElementById("res").value=window.btoa(n);document.getElementById("resname").innerHTML=n;document.getElementById("frozen").style.display="";}function upFrozen(){var n=document.getElementById("res").value;var d=document.getElementById("day").value;
if(d==""){alert("请输入冻结时长");}else{stopall();ajax("../../ServerApi.do?frozen="+n+"&day="+d+"&token="+token,"reData");}}function changemenu(i){var m=document.getElementsByName("box");if(m){for(var j=0;j<m.length;j++){if(j==i){m[j].style.display="";}else{
m[j].style.display="none";}}}endchat();}function setchatsize(){var c=document.getElementById("chat");if(c){var h=document.getElementById("menu").offsetTop-200;if(h<=10){c.style.display="none";}else{c.style.display="";}var w=c.parentNode.clientWidth-26;
c.style.width=w+"px";c.style.height=h+"px";}}window.addEventListener("resize", setchatsize);var getchattime=2,inchattime=0;var cangetchat=false;function getchat(t){ajax("/bbs/gameinfo.do?token="+token+"&getchat="+t,"regetchat");}function regetchat(i){
if(i.indexOf("{")==0){window.location.reload();return;}if(i=="[]"){if(getchattime<10){getchattime+=2;}}else{if(i.indexOf("[")==0){getchattime=2;var c=document.getElementById("chat");var obj=JSON.parse(i);for(var j=0;j<obj.length;j++){c.innerHTML=c.innerHTML+"\n"+obj[j].name
+" >> "+obj[j].msg;}c.scrollTop = c.scrollHeight;}}}function putchat(){var cm=document.getElementById("chatmsg");var m=cm.value;if(m==""){return;}cm.value="";var bm=encodeURIComponent(m);ajax("/bbs/gameinfo.do?token="+token+"&putchat="+bm,"reputchat");}
function reputchat(i){if(i.indexOf("{")==0){window.location.reload();return;}getchattime=2;}function KeyDown(){if(event.keyCode==13){putchat();}}function getpilltime(){document.getElementById("pill").innerHTML="正在读取数据...";document.getElementById("pillbtn").value="--";
ajax("/bbs/gameinfo.do?token="+token+"&pilltime=1","regetpilltime");}getpilltime();var pilltime=-1;function regetpilltime(i){if(i.indexOf("{")==0){window.location.reload();return;}if(i.indexOf("[")==0){var obj=JSON.parse(i);pilltime=parseInt(obj[0].time);
document.getElementById("pill").innerHTML="数据读取完毕";}else{getpilltime();}}function setpilltime(i){if(pilltime>=0){var re="炼丹";if(pilltime>0){pilltime-=i;}if(pilltime>0){re=re+"　(冷却中，"+pilltime+")";}document.getElementById("pillbtn").value=re;}}
function getpill(){if(document.getElementById("pillbtn").value=="炼丹"){stopall();ajax("/bbs/gameinfo.do?token="+token+"&getpill=1","regetpill");}}function regetpill(i){if(i.indexOf("{")==0){window.location.reload();return;}showall();if(i.indexOf("[")==0){pilltime=1800;
setpilltime(0);var obj=JSON.parse(i);document.getElementById("pill").innerHTML=obj[0].pill;setbknum(1);}else{document.getElementById("pill").innerHTML="网络异常，请刷新页面后重试";}}var rescd=0;function setrescd(i){if(rescd>0){rescd-=i;}var r="";if(rescd>0){r="　(冷却中，"+rescd+")";}
var all=document.getElementsByName("res");all[0].value="挖矿"+r;all[1].value="砍树"+r;all[2].value="刷怪"+r;}function getchatrun(){if(cangetchat){inchattime++;if(inchattime>=getchattime){inchattime=0;getchat((new Date()).getTime()-getchattime*1000);}}setrescd(1);
setpilltime(1);setTimeout("getchatrun()",1000);}function startchat(){getchattime=2;cangetchat=true;document.getElementById("chat").innerHTML="此页面与游戏公屏互通。\n聊天可能会存在几秒的延迟，属正常现象。\n\n已连接到服务器。\n";}function endchat(){cangetchat=false;
document.getElementById("chat").innerHTML="";}getchatrun();function setbknum(i){bknum+=i;document.getElementById("bknum").innerHTML=bknum;}setbknum(0);function setresmsg(m){document.getElementById("doout").innerHTML=m;}function getres(i){if(document.getElementsByName("res")[i-1].value.indexOf("(")!=-1){
return;}stopall();ajax("/bbs/gameinfo.do?token="+token+"&getres="+i,"regetres");}function regetres(i){if(i.indexOf("{")==0){window.location.reload();return;}showall();var re="";if(i=="[]"){re="哎呀，什么也没有弄到，休息一下再来吧";}else{if(i.indexOf("[")==0){var obj=JSON.parse(i);
if(obj.length!=1){re="哎呀，什么也没有弄到，休息一下再来吧";}else{re=obj[0].name;if(obj[0].error=="false"){    re="获得了"+re+"　<span onclick='setres()' class='text cupo headusr'>放入离线背包</span>　<span onclick=\"setresmsg('操作成功')\" class='text cupo cff80'>丢弃</span>";}}}}
rescd=11;setrescd(0);setresmsg(re);}function setres(){stopall();ajax("/bbs/gameinfo.do?token="+token+"&resok=1","reresok");}function reresok(i){if(i.indexOf("{")==0){window.location.reload();return;}showall();var re;if(i=="[]"){re="哎呀，东西弄丢了，重新获取吧";}else{setbknum(1);
re="操作成功";}setresmsg(re);}function getToMoney(i){ajax("/bbs/gameinfo.do?token="+token+"&exchange="+i,"regetToMoney");}function regetToMoney(i){if(i.indexOf("{")==0){window.location.reload();return;}showall();var t1="Error",t2="Error";if(i.indexOf("[")==0){var obj=JSON.parse(i);
t1=obj[0].today;t2=obj[0].other;}document.getElementById("todaymoney").innerHTML="<b>"+t1+"</b>(今日回收数量,每日重置)";document.getElementById("othermoney").innerHTML="<b>"+t2+"</b>(额外回收数量,永不过期)";}getToMoney(0);function reOther(i){if(i.indexOf("{")==0){window.location.reload();return;}
if(i.indexOf("[")==0){showall();var obj=JSON.parse(i);alert(obj[0].msg);}}function doOther(t){stopall();ajax("/bbs/gameinfo.do?other="+t+"&token="+token,"reOther");}