var l_name;function login(){var btn=document.getElementById("logbtn");if(btn.innerHTML!="登录"){return;}l_name=document.getElementById("user").value;var pwdt=document.getElementById("pwd");var pwd=pwdt.value;if(pwd.length<6 && pwd.length>0){messageshow("密码至少6位");return;}if(l_name.length<3){messageshow("请输入正确的账号");return;}if(!isPassCaptcha("reCaptcha")){messageshow("请点击验证码进行人机验证");return;}btn.innerHTML="正在登录";pwdt.value="";logins(pwd);}function logins(p){var tp="none";if(p.length>0){tp=enpwd(p);}ajax("LoginApi.do?id="+l_name+"&key="+tp+"&token="+getCaptchaKey("reCaptcha"),"relogajax");}function relogajax(i){var red=document.getElementById("logbtn");if(i=="error"){messageshow("服务器繁忙");red.innerHTML="登录";}else if(i=="2fa"){var code=prompt("请打开二步验证APP，输入上面的动态密码，5分钟内有效。");if(code!=null && code!=""){logins(code);}else{red.innerHTML="登录";}}else if(i=="no"){messageshow("登录失败，此账号已被服务器限制登录");red.innerHTML="禁止登录";return;}else if(i=="false"){InspectionTime(function(){showlogerr();},function(){showlogtime();},function(){showlogerr();},300000);}else if(i=="yzm"){messageshow("人机验证出现异常，请重新点击验证码进行验证");red.innerHTML="登录";}else if(i=="repwd"){messageshow("账户已被紧急冻结，通过找回密码的功能重置密码后可正常使用");red.innerHTML="登录";}else if(i=="200"){messageshow("你错误次数太多，请稍后重试");red.innerHTML="登录";}else if(i.length>20){if(document.getElementById("autolog").checked){addlogkey(l_name,i);}location.reload();return;}else{red.innerHTML="登录";messageshow("未知错误");}reloadCaptcha("reCaptcha");}function showlogerr(){messageshow("账号或密码错误");document.getElementById("logbtn").innerHTML="登录";}function showlogtime(){messageshow("这台电脑的时间似乎不准，请先校准时间");document.getElementById("logbtn").innerHTML="登录";}