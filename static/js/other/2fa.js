function getBase32(ins){var bach="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";var i=0;var index=0;var digit=0;var curr;var next;var re="";for(var i=0;i<ins.length;){curr=(ins.charCodeAt(i)>=0)?ins.charCodeAt(i):(ins.charCodeAt(i)+256);if(index>3){if((i+1)<ins.length){next=(ins.charCodeAt(i+1)>=0)?ins.charCodeAt(i+1):(ins.charCodeAt(i+1)+256)}else{next=0}digit=curr&(255>>index);index=(index+5)%8;digit<<=index;digit|=(next>>(8-index));i++}else{digit=(curr>>(8-(index+5)))&31;index=(index+5)%8;if(index==0){i++}}re=re+bach.charAt(digit)}return re};
var name2fa;var fs=document.getElementById('2fadiv');function load2fa(n){name2fa=n;var c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefhijklmnopqrstuvwxyz0123456789';var l=c.length;var s='';for(var i=0;i<20;i++){s+=c.charAt(Math.floor(Math.random()*l));}s=getBase32(s);document.getElementById("SecretKey").value=s;fs.innerHTML="";load2fa2(s);}function load2fa2(key){var c=new AraleQRCode({"render":"table","text":'otpauth://totp/vifl:'+name2fa+'?secret='+key+'&issuer=vifl',"size":360});fs.appendChild(c);}