var showfile=document.getElementById("list");var showpath=document.getElementById("path");var update="&upd=0";if(path=="/" || path=="\\"){path="";}function newfile(){var p=path;if(p.indexOf("/")==0 || p.indexOf("\\")==0){p=p.substr(1);}
document.getElementById('newfile').action="/bbs/gamefile.do?token="+token+update+"&newfile="+p.replace("#","%23").replace("?","%3F");document.getElementById('f').click();}function newfilec(){showfile.innerHTML="正在上传文件...";}
function newpath(){EjectPrompt("请输入文件名",function(p){showfile.innerHTML="正在获取数据...";p=path+"/"+p;if(p.indexOf("/")==0 || p.indexOf("\\")==0){p=p.substr(1);}ajax("/bbs/gamefile.do?token="+token+update+"&newpath="+p.replace("#","%23").replace("?","%3F"),"rereload");});}
function setupd(i){update="&upd="+i;cd('');}function setsel(type){var p=getSelect();if(p==""){alert("请选中一个目标");return;}EjectFormConfirm('确定要这么做吗？',this,function(){showfile.innerHTML="正在获取数据...";p=path+"/"+p;
if(p.indexOf("/")==0 || p.indexOf("\\")==0){p=p.substr(1);}ajax("/bbs/gamefile.do?token="+token+update+"&"+type+"="+p.replace("#","%23").replace("?","%3F"),"rereload");});}function download(){var p=getSelect();if(p==""){alert("请选中一个目标");
return;}p=path+"/"+p;if(p.indexOf("/")==0 || p.indexOf("\\")==0){p=p.substr(1);}window.open("/bbs/gamefile.do?token="+token+update+"&download="+p.replace("#","%23").replace("?","%3F"));}function rereload(i){reload();}function reload(){cd(path);}
function cd(url){path=url;sp();showfile.innerHTML="正在获取数据...";ajax("/bbs/gamefile.do?token="+token+update+"&url="+url.replace("#","%23").replace("?","%3F"),"recd");}function sp(){var h="";if(path==""){h="<div>根目录</div>";}else{
var ml=path.split("/");var tp="";for(var i=0;i<ml.length;i++){if(ml[i]==""){continue;}if(tp==""){tp=ml[i];}else{tp=tp+"/"+ml[i];}if(i==ml.length-1){h=h+"/"+ml[i];}else{h=h+"/<span class=\"c0088 text\" onclick=\"cd('"+tp+"')\">"+ml[i]+"</span>";}}
h="<div><span onclick=\"cd('')\" class=\"c0088 text\">根目录</span>"+h+"</div>";}showpath.innerHTML=h;}function getList(n,f){if(f){return "<label onclick=\"showFile()\"><div class=\"quick_t pad55\"><input type=\"radio\" name=\"radio\" value=\""+n
+"\" /><img style='margin-top:2px;position:absolute' src='"+cdn+"img/file-16.gif'/>　　"+n+"</div></label>";}else{return "<label onclick=\"showPath()\"><div class=\"quick_t cc060 pad55\"><input type=\"radio\" name=\"radio\" value=\""+n
+"\" /><span class='text' onclick=\"cd('"+path+"/"+n+"')\"><img style='margin-top:2px;position:absolute' src='"+cdn+"img/folder-16.gif'/>　　"+n+"</span></div></label>";}}function getSelect(){var radio=document.getElementsByName("radio");
if(radio){for(var i=0;i<radio.length;i++){if(radio[i].checked){return radio[i].value;}}}return "";}function recd(ti){var l=eval("("+ti+")");var h="";for(var i=0;i<l.length;i++){if(l[i].file==1){continue;}else{h=h+getList(l[i].name,false);}}
for(var i=0;i<l.length;i++){if(l[i].file==1){h=h+getList(l[i].name,true);}else{continue;}}if(h==""){h="此目录下没有任何文件";}showfile.innerHTML=h;showNone();}function showFile(){selectPath("p","none");selectPath("f","");}function showPath(){
selectPath("f","none");selectPath("p","");}function showNone(){selectPath("f","none");selectPath("p","none");}function selectPath(i,d){var o=document.getElementsByName("set"+i);if(o){for(var j=0;j<o.length;j++){o[j].style.display=d;}}}cd(path);